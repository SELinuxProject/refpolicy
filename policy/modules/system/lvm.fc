# LVM creates lock files in /var before /var is mounted
# configure LVM to put lockfiles in /etc/lvm/lock instead
# for this policy to work (unless you have no separate /var)

#
# /etc
#
/etc/lvm(/.*)?			gen_context(system_u:object_r:lvm_etc_t,s0)
/etc/lvm/\.cache	--	gen_context(system_u:object_r:lvm_metadata_t,s0)
/etc/lvm/cache(/.*)?		gen_context(system_u:object_r:lvm_metadata_t,s0)
/etc/lvm/archive(/.*)?		gen_context(system_u:object_r:lvm_metadata_t,s0)
/etc/lvm/backup(/.*)?			gen_context(system_u:object_r:lvm_metadata_t,s0)
/etc/lvm/lock(/.*)?			gen_context(system_u:object_r:lvm_lock_t,s0)

/etc/lvmtab(/.*)?			gen_context(system_u:object_r:lvm_metadata_t,s0)
/etc/lvmtab\.d(/.*)?			gen_context(system_u:object_r:lvm_metadata_t,s0)

/etc/multipath(/.*)?                    gen_context(system_u:object_r:lvm_metadata_t,s0)

#
# /usr
#
/usr/bin/cryptsetup		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/dmraid			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/dmsetup		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/dmsetup\.static	--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/e2fsadm		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvchange		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvcreate		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvdisplay		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvextend		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvm			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvmetad		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvm\.static		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvmchange		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvmdiskscan		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvmiopversion		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvmsadc		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvmsar			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvreduce		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvremove		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvrename		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvresize		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvs			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/lvscan			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/multipathd		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/multipath\.static	--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/pvchange		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/pvcreate		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/pvdata			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/pvdisplay		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/pvmove			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/pvremove		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/pvs			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/pvscan			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgcfgbackup		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgcfgrestore		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgchange		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgchange\.static	--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgck			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgcreate		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgdisplay		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgexport		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgextend		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgimport		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgmerge		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgmknodes		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgreduce		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgremove		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgrename		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgs			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgscan			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgscan\.static		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgsplit		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/bin/vgwrapper		--	gen_context(system_u:object_r:lvm_exec_t,s0)

/usr/lib/lvm-10/.*				--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/lib/lvm-200/.*				--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/lib/systemd/systemd-cryptsetup		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/lib/systemd/system/blk-availability.*	--	gen_context(system_u:object_r:lvm_unit_t,s0)
/usr/lib/systemd/system/dm-event.*		--	gen_context(system_u:object_r:lvm_unit_t,s0)
/usr/lib/systemd/system/lvm2-.*			--	gen_context(system_u:object_r:lvm_unit_t,s0)
/usr/lib/systemd/system/lvm2-lvmetad.*		--	gen_context(system_u:object_r:lvm_unit_t,s0)
/usr/lib/udev/udisks-lvm-pv-export		--	gen_context(system_u:object_r:lvm_exec_t,s0)

/usr/sbin/cryptsetup		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/dmraid		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/dmsetup		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/dmsetup\.static	--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/e2fsadm		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvchange		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvcreate		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvdisplay		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvextend		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvm			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvmetad		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvm\.static		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvmchange		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvmdiskscan		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvmiopversion		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvmsadc		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvmsar		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvreduce		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvremove		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvrename		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvresize		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvs			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/lvscan		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/multipath             --      gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/multipathd		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/multipath\.static	--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/pvchange		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/pvcreate		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/pvdata		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/pvdisplay		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/pvmove		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/pvremove		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/pvs			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/pvscan		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgcfgbackup		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgcfgrestore		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgchange		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgchange\.static	--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgck			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgcreate		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgdisplay		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgexport		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgextend		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgimport		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgmerge		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgmknodes		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgreduce		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgremove		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgrename		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgs			--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgscan		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgscan\.static	--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgsplit		--	gen_context(system_u:object_r:lvm_exec_t,s0)
/usr/sbin/vgwrapper		--	gen_context(system_u:object_r:lvm_exec_t,s0)

#
# /var
#
/var/cache/multipathd(/.*)?		gen_context(system_u:object_r:lvm_metadata_t,s0)
/var/lib/multipath(/.*)?		gen_context(system_u:object_r:lvm_var_lib_t,s0)
/var/lock/lvm(/.*)?			gen_context(system_u:object_r:lvm_lock_t,s0)
/run/cryptsetup(/.*)?			gen_context(system_u:object_r:lvm_runtime_t,s0)
/run/multipathd\.sock		-s	gen_context(system_u:object_r:lvm_runtime_t,s0)
/run/dmevent.*				gen_context(system_u:object_r:lvm_runtime_t,s0)
/run/lvm(/.*)?				gen_context(system_u:object_r:lvm_runtime_t,s0)
